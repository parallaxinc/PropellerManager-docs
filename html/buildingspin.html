---
layout: doc
title: PropellerManager - Building Spin Projects With `qmake`
doctitle: PropellerManager
doctagline: An event-driven C++ API for Propeller devices
docurl: /propellermanager/
---
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
                    <div style="margin-bottom: 15px;">
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Overview</a></li><li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Building Spin Projects With `qmake` </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A common use of <a class="el" href="class_propeller_manager.html" title="The PropellerManager class provides an abstraction layer between PropellerSession and PropellerDevice...">PropellerManager</a> is to load special firmware to a board. The main question that arises is how to make the code available to your application. You could just stick it in a directory and update the firmware when you need to, but that gets annoying to maintain very fast.</p>
<p>A more elegant approach is to embed your firmware directly into your application. That way it's always up-to-date and always available when you need it.</p>
<p>In this tutorial, we will show you how to do just that, using code taken from BadgeHacker, a tool that downloads and configures firmware for the Hackable Electronic Badge using <a class="el" href="class_propeller_manager.html" title="The PropellerManager class provides an abstraction layer between PropellerSession and PropellerDevice...">PropellerManager</a>.</p>
<p><a href="http://developer.parallax.com/badgehacker/">http://developer.parallax.com/badgehacker/</a></p>
<h3>Building the binary</h3>
<p>To begin, we need to create a <code>qmake</code> project file that can build Spin projects. This is fairly easy to make.</p>
<p><a href="https://github.com/parallaxinc/BadgeHacker/blob/master/spin/spin.pro">spin/spin.pro</a> </p><pre class="fragment">CONFIG -= qt
TEMPLATE = aux

spin.target = jm_hackable_ebadge.binary
spin.commands = openspin jm_hackable_ebadge.spin
spin.depends = $$files(*.spin)

PRE_TARGETDEPS = jm_hackable_ebadge.binary
QMAKE_EXTRA_TARGETS = spin
</pre><p>Then, you can include your binary in your main program with an include file:</p>
<p><a href="https://github.com/parallaxinc/BadgeHacker/blob/master/spin/include.pri">spin/include.pri</a> </p><pre class="fragment">PRE_TARGETDEPS += $$PWD/jm_hackable_ebadge.binary
RESOURCES += $$PWD/spin.qrc
</pre><p>The <code>PRE_TARGETDEPS</code> command tells qmake that your program depends on this other binary, so it will recompile if the binary is changed.</p>
<p>The <code>RESOURCES</code> part compiles the helper binary into the program (it also included the Spin file for another reason).</p>
<p>Here are the contents of the resource file:</p>
<p><a href="https://github.com/parallaxinc/BadgeHacker/blob/master/spin/spin.qrc">spin/spin.qrc</a> </p><pre class="fragment">&lt;!DOCTYPE RCC&gt;&lt;RCC version="1.0"&gt;
&lt;qresource prefix="/spin"&gt;
    &lt;file&gt;jm_hackable_ebadge.binary&lt;/file&gt;
    &lt;file&gt;jm_hackable_ebadge.spin&lt;/file&gt;
&lt;/qresource&gt;
&lt;/RCC&gt;
</pre><h3>Embedding the binary</h3>
<p>Here's how to include your dependency and resource in the main program:</p>
<p><a href="https://github.com/parallaxinc/BadgeHacker/blob/master/src/src.pro">src/src.pro</a> </p><pre class="fragment">include(../spin/include.pri)
</pre><p>After you've compiled in the resource, you can use it just like any other file in your program. Here's a snippet from BadgeHacker where I am downloading a Spin binary that's compiled into the program. It's a part of your executable so you never have to worry about that file not being found.</p>
<p><a href="https://github.com/parallaxinc/BadgeHacker/blob/master/src/badge.cpp">src/badge.cpp</a> </p><pre class="fragment">QFile file(":/spin/jm_hackable_ebadge.binary");
file.open(QIODevice::ReadOnly);
PropellerImage image = PropellerImage(file.readAll());
return loader-&gt;upload(image, true);
</pre><p>As you can see, the Qt resource system is very powerful and allows me to work a lot of magic. Coupled with <a class="el" href="class_propeller_manager.html" title="The PropellerManager class provides an abstraction layer between PropellerSession and PropellerDevice...">PropellerManager</a>, it's fantastically easy to embed any kind of content, including Spin helper programs, into your applications.</p>
<p>Woohoo!** </p>
</div></div><!-- contents -->
</div>
</div>
